---
import Layout from "../../layouts/Layout.astro"

---

<Layout>
  <form action="http://localhost:8080/api/guess" method="POST">
  <label for="guess">Guess:</label>
  <input type="text" id="guess" name="guess" required>

  <button id="submitButton">Absenden</button>
  </form>
</Layout>
<script>
  interface UserData {
    guess: string;
  }

  async function sendData(data: UserData): Promise<void> {
    try {
      const response = await fetch('http://localhost:8080/api/guess', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(data),
      });

      if (!response.ok) {
        throw new Error(`Fehler: ${response.statusText}`);
      }

      const responseData = await response.text();
      console.log('Serverantwort:', responseData);
    } catch (error) {
      console.error('Fehler beim Senden der Daten:', error);
    }
  }

  // Event-Listener für Formularabsenden
  document.getElementById('submitButton')?.addEventListener('click', () => {
    const guessInput = (document.getElementById('guess') as HTMLInputElement).value;

    if (guessInput) {
      const userData: UserData = {
        guess: guessInput
      };

      sendData(userData);
    } else {
      alert('Bitte alle Felder ausfüllen!');
    }
  });
</script>